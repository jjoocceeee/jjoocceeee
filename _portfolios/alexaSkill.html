---
layout: portfolio
title:  "Tech Tutorial: How to build an Alexa Skill"
description: Building an Alexa Skill with Example + Tips + Tricks
background: '/assets/Images/background/computer_far.jpg'
thumbnail: '/assets/Images/website_working.jpg'
---
<div class="container">
  <div class="row">
    <div class="col">
      <h3>Building an Alexa Skill Example</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        A few months ago, I started building my first Alexa Skill. My last name is Holladay, so naturally, the first skill I wanted to make was about Holidays! I spent a few days building a skill that would tell you all the holidays (both national, and unofficial) for the current day! Well… before I had time to publish this skill, Amazon, (5 steps ahead like always) pushed a native National Calendar App for Alexa. How can I compete with that?
      </p>
      <p>
        Instead of wasting my time continuing to build something that is already out there (and natively too, no download required!), I decided to just release my code for the Alexa Skill, and write a tutorial on how I built my first Alexa Skill.
      </p>
      <p>
        You can find my Alexa Source Code here: 
        <a href="https://github.com/jjoocceeee/AlexaSkill_DailyHolidays">https://github.com/jjoocceeee/AlexaSkill_DailyHolidays</a>
        , (I even have created a graphql endpoint for you to query from, because let’s be real, the tutorials that just say Hello World are not that useful). I will also sprinkle in all the tips and tricks I have learned to make development for Alexa much faster and easier. By the end, you will have read a full tutorial for how to create an Alexa skill. 
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        Before we get started, let’s get a few Alexa Skill things figured out.
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h3>Alexa Skill Basics</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        Alexa Skills come with a few new words with different meaning. Specifically, Invocation Name, Intents, Samples, and Slots. Here are my unofficial overly simple definitions for these. 
      </p>
      <p>
        <strong>Invocation Name:</strong> The words used to trigger your skill, so Alexa knows you are talking to the skill, not her. Mine was “Holiday Calendar”
      </p>
      <p><strong>Intents, Samples, and Slots: </strong>
        What will be said to trigger a certain command that your skill will respond to. You will need to name your intent, as well as provide words which will trigger this intent. For my Holiday Skill, I chose the intent “Todays Holidays” and it is triggered by a combination of phrases similar to "todays holiday" (Shown below). 
      </p>
      <p>
        More details can be found in <a href="https://developer.amazon.com/docs/custom-skills/steps-to-build-a-custom-skill.html">Amazon Alexa's Documentation</a>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h3>Alexa Development</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        Now back to the tutorial… First thing is first, you will need to create an Alexa Developer account 
        <a href="https://developer.amazon.com/alexa/console/ask">https://developer.amazon.com/alexa/console/ask</a>
        Once you have an account, make create a Skill. These steps are fairly simple, so I will leave you to it. Make sure to select a <strong>Custom Skill</strong> with the <strong>Provision your Own</strong> backend resource if you want to copy exactly what I built.
      </p>
      <p>
        <strong>TIP:</strong> I chose to provide my own backend, mostly because I prefer to develop locally on my own IDE. Using the <storng>Alexa-Hosted </storng>option, you will be required to use their in browser IDE, which is a little janky IPO.
      </p>
      <p>
          My Invocation Name was Holiday Calendar.          
      </p>
      <p>
        I only have one intent called TodaysHolidayIntent with these sample utterances.
      </p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/IntentImage.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/IntentImage.jpg" alt="Amazon Alexa Skill Utterance">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>An Invocation Name and an utterance are the two basic items you need to create an Alexa Skill. Wow! your Alexa skill, is ALMOST completely configured. Next you need to provide a backend API. In the left-hand side navigation bar, there is a button which says <strong>Endpoint</strong>. Open that page, and keep it open for a second. We will go back to it.</p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/endpoint.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/endpoint.jpg" alt="Amazon Alexa Skill Endpoint">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        <h4>Backend API</h4>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
          The backend. A.k.a where the brains of the Alexa Skill exist. The most common and recommended way is to build a back end using a lambda functions. A lambda function is an AWS Amazon Serverless server. What is means is that the server is off until it is triggered. Then the server will come alive and execute the code, and go back to sleep. This is helpful because you only need to pay for time that the server is running, instead of having it running constantly.
          The next few steps will help you create a lambda backend to handle your Alexa Skills Intents. We will:
          <ol>
            <li>Create an AWS account</li>
            <li>Create a Lambda Function</li>
            <li>Configure Lambda Function to look for Alexa Skill Intents (this is what will wake it up)</li>
            <li>Add the code</li>
            <li>Let Your Alexa Skill know where your Lambda function exists, so that the Skill can send it the requests and get a response.</li>
          </ol>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h4>Creating an AWS Account & Lambda Function</h4>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        If you  don’t already have an AWS Account, you can create one <a href="https://portal.aws.amazon.com/billing/signup#/start">here</a>
      </p>
      <p>
        For what we are doing, we will be working in the free tier, so don’t worry about this costing anything, but you will still need to add your credit card anyway, sneaky Amazon.
      </p>
      <p>
          I will assume that you can figure out how to create an AWS account, you know fill in your name address, credit card number, all that jazz. So I will skip straight to creating the lambda function.
      </p>
      <p>
        Once at the AWS Management Console, select Lambda to go to the Lambda Services. You may have to search for it in the search bar like below.
      </p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/lambda_1.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/lambda_1.jpg" alt="AWS Console">
      </a>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/lambda_2.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/lambda_2.jpg" alt="AWS Lambda Function">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        Create a Lambda function by pressing the large orange button that says “<strong>Create Function</strong>” hard to miss.
      </p>
      <p>
        I always create my function from <strong>scratch</strong>. Give your function a name and press that orange button again!
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h4>Configure Lambda for Alexa Skill</h4>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        Once the function is created, we need to add an Alexa Skill Intent. This magically configures your Alexa Skill’s Intents with this lambda function, so that only your Alexa Skill can wake up the server! 
      </p>
      <p>
        Remember that page in the Alexa Console where you add in a backend to your Alexa Skill (I said we would be going back to it, remember?) Well from that page, copy your skill Id. Add that into the Alexa Skill Kit Trigger Skill Id. Press the orange Add button. 
      </p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/Add_Alexa_trigger.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/Add_Alexa_trigger.jpg" alt="AWS Lambda Function">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h4>Add Code to Lambda Function</h4>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>Lambda functions are bare bone servers, so for any additional libraries, you will need to supply the library code directly. 
          a.k.a you need to import your node_modules folder to use any outside libraries. 
      </p>
      <p>
          So the easiest way to import your lambda function is to write the code locally (in Visual Studio Code or something like that), and zip up all your code, (including the node_modules) and drag + drop it into the lambda function. So we will do that!
      </p>
      <p>
          If you want to copy my code, you can either clone my <a href="https://github.com/jjoocceeee/AlexaSkill_DailyHolidays">repo</a> or copy and paste the code snippets below in an index.js file. Let’s go through the contents of the index.js, the meat of the Alexa Skill
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <script src="https://gist.github.com/jjoocceeee/1ff9e4b1af2a05a595e612687bcacaf3.js"></script>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>
        The export.handler = async function(event, context) is the entry point for a simple Alexa Skills lambda (courtesy of the <i>ask-sdk-cor</i> API), here we will add custom Intent Handlers.
      </p>
      <p>
        In the <b>.addRequestHandlers()</b> function, you add the name of the function to handle a skill. You can add multiple handles to correspond to multiple intents. For this example, we will just be using the TodaysHolidayIntentHandler to handle our TodaysHoliday Intent.
      </p>
      <p>
        Once the handler is defined in the addRequestHandlers, we need to create the function which will hold the code.
      </p>
      <p>
        I want to stop here and point out that what we will be writing next will be in Node.js ES6. This allows us to use async/await and to build promises. Lambda fully supports this, so no pre-compiling with babel or webpack to use this code.
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <script src="https://gist.github.com/jjoocceeee/3fd4322dece989ad4e61aae05c1f4443.js"></script>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>In the intent Handler definition, first the intent is checked to make sure that this handler is the correct location to go for this intent. This is done by 
        <ol>
          <li>Checking to make sure the request coming in, is an IntentRequest</li>
          <li>Making sure the intent Name is ‘TodaysHolidayIntent’ (remember, this is what we named our intent in the Alexa configuration. </li>
        </ol>  
       </p>
       <p>This <b>canhandle()</b> function has a callback where the intent is actually handled. </p>
       <p>Inside this callback function, we will return the <b>getTodayHolidays()</b> function, a different function that does the work for the intent.</p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <script src="https://gist.github.com/jjoocceeee/da80a5f6ffc2929b13a3afd82ca26f28.js"></script>
    </div>
  </div>
  <div  class="row">
    <div class="col">
      <p><b>GetTodayHolidays</b> will send a request to the graphql api I created which contains a database of holidays. You will need to replace the api url with this: https://limitless-island-47396.herokuapp.com/graphql</p>
      <p>What is going on: 
        <ol>
          <li>We get out the intent from parameter passed into the function</li>
          <li>We send an API call to the graphql endpoint which will communicate with the data base (to learn more about graphql checkout (https://graphql.org/)</li>
          <li>Create a string response (called HolidayText in this case)</li>
          <li>Append the API response to the HolidayText</li>
          <li>Convert the Text (HolidayText) into an Alexa response</li>
          <li>Return the Alexa Response.</li>
        </ol>
      </p>
      <p>
        That’s it! The TodaysHolidayIntent will be handled, and will send back the holidays for today. Now we just need to let Alexa know that this is ready by pushing our intent handling code up to our lambda function in Amazon AWS.
      </p>
      <p>
          Remember? Uploading to a lambda function is simple, you just zip up your files (node_modules included) and import it into your Lambda. After doing this many different times, and ending up with a desktop full of zipped files, I did a google search to find an automated way to zip up my files, and upload them to aws lambda.
      </p>
      <p>I found this nifty little tutorial to help me out, (<a href="https://developer.amazon.com/blogs/post/Tx1UE9W1NQ0GYII/Publishing-Your-Skill-Code-to-Lambda-via-the-Command-Line-Interface">https://developer.amazon.com/blogs/post/Tx1UE9W1NQ0GYII/Publishing-Your-Skill-Code-to-Lambda-via-the-Command-Line-Interface</a>) which creates bash script which will manually upload the function, instead of having to drag and drop the zipped file into the Lambda function directly. (Keep in mind that after every change or new library added, you will need to rezip your project and drag+drop it into the AWS lambda. This is why this script is much easier)</p>
    <p>Mine looks like this: </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <script src="https://gist.github.com/jjoocceeee/4512a02723b8ee0c7180de309b5bac07.js"></script>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>When I run this publish script, My folder will be zipped up and sent to my Alexa Skill. I literally copied and pasted the code in the blog (Thank you open source community!).</p>
      <p>Now all that is left to do is to do is just let the Alexa skill where our AWS Lambda is located. At the top of your lambda function console, there is an ARN. Just copy this and paste it back into the Default Region of your Alexa Skill Service Endpoint (make sure you select the AWS Lambda ARN type).</p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/copySkillId.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/copySkillId.jpg" alt="AWS Lambda Function">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>Now you are done!!! I won’t leave you completely hanging, next we will go over how to Test your Alexa skill.</p>
      <p>We don’t want to always have to test in our AWS lambda console or Alexa Testing, because what if you are offline? This is a janky process that takes time and a few too many steps. It would be much easier to write the code and test it locally and offline, but how do we do that?</p>
      <p>Duh-duh-duh a google search saved the day. I found this article which shows you a trick to trick your code into thinking it is a lambda function, and receiving a triggered event from your Alexa Skill. Link is here <a href="https://medium.com/@moonahmad/how-to-test-alexa-locally-6d498e307a8">https://medium.com/@moonahmad/how-to-test-alexa-locally-6d498e307a8</a> . You can read it for details, but the high level description is, install a lambda replicator package, and send an event formatted response to your code.</p>
      <p>To install the Lambda replicator run in  the command line: <strong> npm install -g lambda-local</strong></p>
      <p>Create an event.json containing the following:  </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <script src="https://gist.github.com/jjoocceeee/bfa635b40e09e80569f04febf445e8b7.js"></script>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>In reality, all that really matters is the last request section. The part with the actual request, and the intent! But just to be safe, I added it all.</p>
      <p>So you might be wondering, how did I get this event? Or how will you know what to replace with the replace_me’s in the code…Well I took the easy way out and just copied and pasted the event sent when testing my Alexa Skill in the Alexa Skill Console (this will be the last time you have to test here!). I copied and pasted what Alexa Skill sent when testing in the Alexa Skills Console. I took this exactly, and pasted it into my event.json, easy as pie.</p>
    </div>
  </div>
  <div class="row justify-content-center align-items-center imageContainer">
    <div class="col-12">
      <a target="_blank" href="/assets/Images/posts/AlexaSkillTutorial/Testing_alexa_console.jpg">
      <img class="basic-image outline-image" src="/assets/Images/posts/AlexaSkillTutorial/Testing_alexa_console.jpg" alt="AWS Lambda Function">
      </a>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p>To run your local test, after you have modified your code in the command line, run: <strong>lambda-local -l index.js -h handler -e path_to/event.json</strong></p>
      <p>Now you can debug locally! Once everything is running perfectly, locally, and you want to release your code to the wild, wild west, use the Publish script we created above. Now you can also test from the Alexa console, or on your actual Alexa Device! Magic! Try it, say <strong>“Alexa, Ask Holiday Calelndar for today’s Holiday”</strong></p>
    </div>
  </div>






</div>